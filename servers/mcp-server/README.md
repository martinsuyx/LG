# demo-admin MCP Server

This package provides a lightweight Model Context Protocol (MCP) server that stores every logged turn of a conversation to disk. It communicates over STDIN/STDOUT using newline-delimited JSON-RPC 2.0 envelopes so it can be embedded inside any MCP-compatible runtime.

## Capabilities
- `tools/list` advertises available tools.
- `tools/call` currently supports:
  - `log_message`: appends a `{ role, content }` entry (plus metadata) to the persisted log.
  - `export_conversation`: returns all recorded entries.
- `resources/list` exposes the `conversation://latest` resource.
- `resources/read` returns the JSON conversation log associated with `conversation://latest`.
- `ping` and `shutdown` provide basic liveness management.

All messages are written to `data/conversation.json`. The file is created on first run and can be mounted or tailed to monitor the ongoing dialogue.

## Running locally

```bash
pnpm --filter @demo-admin/mcp-server start
# or directly
node servers/mcp-server/src/index.js
```

Send JSON-RPC 2.0 requests line by line on STDIN. For example:

```bash
printf '{"jsonrpc":"2.0","id":1,"method":"initialize"}\n' | node servers/mcp-server/src/index.js
```

To log a message after the server has been initialised:

```bash
cat <<'EOF' | node servers/mcp-server/src/index.js
{"jsonrpc":"2.0","id":1,"method":"initialize"}
{"jsonrpc":"2.0","id":2,"method":"tools/call","params":{"name":"log_message","arguments":{"role":"user","content":"Hello MCP!"}}}
{"jsonrpc":"2.0","id":3,"method":"tools/call","params":{"name":"export_conversation","arguments":{}}}
EOF
```

## Conversation log format

`conversation.json` keeps an ordered array of entries. Each entry contains:
- `role`: `system | user | assistant | tool`
- `content`: string content of the turn
- `metadata`: optional object for free-form metadata
- `timestamp`: ISO 8601 string generated by the server

You can consume the conversation either via the `export_conversation` tool or by reading the `conversation://latest` resource.
