<!DOCTYPE html>
<html lang="zh-CN"><head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>è®¢å•åˆ—è¡¨ Â· åˆå®¡</title>
<link rel="stylesheet" href="../assets/app.css"/>
</head>
<body>
<div class="layout">
<header><div class="brand">ğŸ”¶ åå°ç®¡ç†å¹³å° <span class="env">Demo</span></div><div class="hint">è®¢å•åˆ—è¡¨ï¼ˆåˆå®¡ï¼‰ Demo</div></header>
<aside>
<nav class="menu">
<h4>èµ„é‡‘ä¸è´¦æˆ·</h4>
<a href="../finance/finance-recharge.html">å®¢æˆ·å……å€¼ç®¡ç†</a>
<h4>æ´»åŠ¨ä¸ä»»åŠ¡</h4>
<a href="../campaigns/campaigns.html">æ´»åŠ¨åˆ—è¡¨</a>
<h4>è®¢å•ä¸å®¡æ ¸</h4>
<a href="./orders.html" class="active">è®¢å•åˆ—è¡¨ï¼ˆåˆå®¡ï¼‰</a>
<a href="./review-second.html">å¤å®¡åˆ—è¡¨</a>
<a href="./evidence-library.html">è¯æ®åº“</a>
<a href="./supplement-withdraw.html">è¡¥ä»¶&æ’¤å›</a>
<h4>å¯¼èˆª</h4>
<a href="../index.html">è¿”å›é¦–é¡µ</a>
</nav>
</aside>
<main>
<div class="card">
<div class="toolbar">
<div class="filters">
<input type="text" id="kw" placeholder="è®¢å•ID/æäº¤äºº/é—¨åº—â€¦"/>
<select id="state">
<option value="submitted">å¾…å®¡æ ¸</option>
<option value="manual_review">å¤å®¡ä¸­</option>
<option value="approved">å·²é€šè¿‡</option>
<option value="rejected">å·²æ‹’ç»</option>
</select>
<button class="btn ghost" id="btnFilter">ç­›é€‰</button>
</div>
<div>
<button class="btn primary" id="btnBatchPass">æ‰¹é‡é€šè¿‡</button>
<button class="btn danger" id="btnBatchReject" style="margin-left:8px">æ‰¹é‡æ‹’ç»</button>
</div>
</div>
<div id="tbl"></div>
</div>
</main>
</div>
<div class="drawer"><div class="head"><div>è®¢å•è¯¦æƒ…</div><div><button class="btn" onclick="closeDrawer()">å…³é—­</button></div></div><div class="body" id="drawerBody"></div></div>
<script type="module">
import { $, openDrawer, closeDrawer, toast } from '../assets/app.js';
const orders=[
{id:'O-2001', activity:'å¹¿å·ç§»åŠ¨', store:'é—¨åº—A', submitter:'é˜Ÿå‘˜B', amount:199, state:'submitted', time:'2025-09-20 11:00', risk:['geo_out_of_fence']},
{id:'O-2002', activity:'å¹¿å·ç§»åŠ¨', store:'é—¨åº—C', submitter:'é˜Ÿå‘˜D', amount:59, state:'submitted', time:'2025-09-20 12:10', risk:[]},
];
function tag(s){const map={submitted:'å¾…å®¡æ ¸',manual_review:'å¤å®¡ä¸­',approved:'å·²é€šè¿‡',rejected:'å·²æ‹’ç»'}; const cls={submitted:'pending',manual_review:'pending',approved:'confirmed',rejected:'failed'};return `<span class='tag ${cls[s]||'pending'}'>${map[s]||s}</span>`}
function render(){
const kw=$('#kw').value.trim().toLowerCase(); const st=$('#state').value;
let list=orders.filter(o=>o.state===st||!st).filter(o=>!kw||[o.id,o.submitter,o.store].join('|').toLowerCase().includes(kw));
$('#tbl').innerHTML=`<table><thead><tr>
<th><input type='checkbox' id='all'/></th><th>è®¢å•ID</th><th>æ´»åŠ¨</th><th>é—¨åº—</th><th>æäº¤äºº</th><th>é‡‘é¢</th><th>é£é™©</th><th>çŠ¶æ€</th><th>æ—¶é—´</th><th>æ“ä½œ</th>
</tr></thead><tbody>${list.map((o,i)=>`<tr>
<td><input type='checkbox' data-idx='${i}'/></td>
<td><a href='./order-detail.html?id=${o.id}'>${o.id}</a></td>
<td>${o.activity}</td><td>${o.store}</td><td>${o.submitter}</td>
<td class='amount'>Â¥ ${o.amount.toLocaleString('zh-CN')}</td>
<td>${o.risk.length?`<span class='tag failed'>${o.risk[0]}</span>`:'â€”'}</td>
<td>${tag(o.state)}</td><td>${o.time}</td>
<td>
<button class='btn primary' onclick='pass(${i})'>é€šè¿‡</button>
<button class='btn danger' onclick='reject(${i})'>æ‹’ç»</button>
<button class='btn' onclick='review(${i})'>è½¬å¤å®¡</button>
</td>
</tr>`).join('')}</tbody></table>`;
$('#all').onchange=(e)=>document.querySelectorAll('[data-idx]').forEach(c=>c.checked=e.target.checked);
}
window.pass=(i)=>{ orders[i].state='approved'; toast('å·²é€šè¿‡','success'); render(); }
window.reject=(i)=>{ orders[i].state='rejected'; toast('å·²æ‹’ç»','error'); render(); }
window.review=(i)=>{ orders[i].state='manual_review'; toast('å·²è½¬å¤å®¡','success'); render(); }
$('#btnFilter').onclick=render;
$('#btnBatchPass').onclick=()=>{ document.querySelectorAll('[data-idx]:checked').forEach(c=>{ orders[Number(c.getAttribute('data-idx'))].state='approved' }); toast('æ‰¹é‡é€šè¿‡å®Œæˆ','success'); render(); }
$('#btnBatchReject').onclick=()=>{ document.querySelectorAll('[data-idx]:checked').forEach(c=>{ orders[Number(c.getAttribute('data-idx'))].state='rejected' }); toast('æ‰¹é‡æ‹’ç»å®Œæˆ','error'); render(); }
render();
</script>
</body></html>