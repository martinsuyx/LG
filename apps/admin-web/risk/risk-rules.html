<!DOCTYPE html>
<html lang="zh-CN"><head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>é£æ§è§„åˆ™åº“</title>
<link rel="stylesheet" href="../assets/app.css"/>
</head>
<body>
<div class="layout">
<header><div class="brand">ğŸ”¶ åå°ç®¡ç†å¹³å° <span class="env">Demo</span></div><div class="hint">é£æ§è§„åˆ™åº“ Demo</div></header>
<aside>
<nav class="menu">
<h4>é£æ§ä¸åˆè§„</h4>
<a href="./risk-rules.html" class="active">è§„åˆ™åº“</a>
<a href="./risk-lists.html">é»‘ç™½åå•</a>
<a href="./risk-devices.html">è®¾å¤‡ç”»åƒ</a>
<a href="./risk-geofence.html">åœ°ç†å›´æ </a>
<a href="./risk-monitor.html">ç›‘æ§çœ‹æ¿</a>
<a href="./risk-tickets.html">å‘½ä¸­å·¥å•</a>
<a href="./appeals.html">ç”³è¯‰ä¸å¤æ ¸</a>
<a href="./kyc-review.html">KYC å®¡æ ¸</a>
<a href="./esign.html">ç”µå­ç­¾çº¦</a>
<h4>å¯¼èˆª</h4>
<a href="../index.html">è¿”å›é¦–é¡µ</a>
</nav>
</aside>
<main>
<div class="card">
<div class="toolbar"><div>è§„åˆ™æ¸…å•</div><div><button class="btn primary" id="btnNew">æ–°å»ºè§„åˆ™</button></div></div>
<div id="tbl"></div>
</div>
</main>
</div>
<div class="drawer"><div class="head"><div>è§„åˆ™ç¼–è¾‘</div><div><button class="btn" onclick="closeDrawer()">å…³é—­</button></div></div><div class="body" id="drawerBody"></div></div>
<script type="module">
import { $, openDrawer, closeDrawer, toast } from '../assets/app.js';
let rules=[
{id:'R-1001', name:'åŒå·å¤šå•', type:'velocity', action:'review', status:'active', hits:32, version:'r-2025.09.01'},
{id:'R-1002', name:'åœ°ç†è¶Šç•Œ', type:'geo', action:'reject', status:'inactive', hits:12, version:'r-2025.08.20'},
];
function tag(s){return `<span class='tag ${s==='active'?'confirmed':'failed'}'>${s}</span>`}
function render(){
$('#tbl').innerHTML=`<table><thead><tr><th>ID</th><th>åç§°</th><th>ç±»å‹</th><th>åŠ¨ä½œ</th><th>çŠ¶æ€</th><th>å‘½ä¸­</th><th>ç‰ˆæœ¬</th><th>æ“ä½œ</th></tr></thead>
<tbody>${rules.map(r=>`<tr>
<td>${r.id}</td><td>${r.name}</td><td>${r.type}</td><td>${r.action}</td><td>${tag(r.status)}</td><td>${r.hits}</td><td>${r.version}</td>
<td><button class='btn' onclick='edit("${r.id}")'>ç¼–è¾‘</button>
<button class='btn' onclick='pub("${r.id}")'>å‘å¸ƒ</button>
<button class='btn' onclick='rb("${r.id}")'>å›æ»š</button>
<button class='btn' onclick='toggle("${r.id}")'>å¯åœ</button></td></tr>`).join('')}</tbody></table>`;
}
window.edit=(id)=>{ const r=rules.find(x=>x.id===id); if(!r) return; openDrawer(); $('#drawerBody').innerHTML=`
<div class='desc'>
<div class='row'><div class='label'>åç§°</div><div class='value'><input id='name' value='${r.name}' style='height:34px;padding:0 10px;border:1px solid var(--line);border-radius:8px'></div></div>
<div class='row'><div class='label'>åŠ¨ä½œ</div><div class='value'><select id='act'><option ${r.action==='allow'?'selected':''}>allow</option><option ${r.action==='review'?'selected':''}>review</option><option ${r.action==='reject'?'selected':''}>reject</option><option ${r.action==='freeze'?'selected':''}>freeze</option></select></div></div>
<div class='row'><div class='label'>æ¡ä»¶</div><div class='value'><textarea id='cond' rows='4' style='width:100%;border:1px solid var(--line);border-radius:8px'>{"field":"mobile","op":"count>=","window":"24h","value":3}</textarea></div></div>
</div>
<div style='margin-top:12px'><button class='btn primary' id='ok'>ä¿å­˜</button> <button class='btn' onclick='closeDrawer()'>å–æ¶ˆ</button></div>`;
$('#ok').onclick=()=>{ r.name=$('#name').value||r.name; r.action=$('#act').value; toast('å·²ä¿å­˜','success'); render(); closeDrawer(); };
}
window.pub=(id)=>{ toast('å·²å‘å¸ƒ Â· '+id,'success') }
window.rb=(id)=>{ toast('å·²å›æ»š Â· '+id,'success') }
window.toggle=(id)=>{ const r=rules.find(x=>x.id===id); r.status=r.status==='active'?'inactive':'active'; render(); }
$('#btnNew').onclick=()=>{ rules.unshift({id:'R-'+Math.floor(Math.random()*1e5),name:'æ–°è§„åˆ™',type:'custom',action:'review',status:'inactive',hits:0,version:'r-NEW'}); render(); }
render();
</script>
</body></html>