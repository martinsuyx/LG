import{O as we,d as ye,r as b,a as W,c as M,o as We,b as c,e as t,A as k,B as m,t as i,k as ne,i as B,v as X,j as ge,F as E,h as j,f as se,E as he,g as Xe,G as F,q as d,s as g,_ as Ye}from"./index-DvtP9USg.js";import{B as C}from"./Button-BaguUGDy.js";import{M as ke}from"./Modal-CtEdl0zk.js";import{T as be}from"./Table-BsZuLW91.js";import{P as Ze}from"./Pagination-3ermIvaY.js";function x(){return{"Content-Type":"application/json",...we.HEADERS||{}}}function S(r,o){var n;const v=((n=we.BASE)==null?void 0:n.replace(/\/$/,""))||"";if(!o||Object.keys(o).length===0)return`${v}${r}`;const h=new URLSearchParams;Object.entries(o).forEach(([w,y])=>{if(!(y==null||y==="")){if(Array.isArray(y)){y.length&&h.append(w,y.join(","));return}h.append(w,String(y))}});const D=h.toString();return D?`${v}${r}?${D}`:`${v}${r}`}async function z(r,o){const v=await fetch(r,o);if(!v.ok){let D=`Request failed with ${v.status}`,n=null;const w=v.headers.get("content-type")||"";try{if(w.includes("application/json")){if(n=await v.json(),n&&typeof n=="object"&&"message"in n){const R=n.message;typeof R=="string"&&R.trim().length&&(D=R)}}else{const R=await v.text();R.trim().length&&(D=R)}}catch{}const y=new Error(D);throw n&&typeof n=="object"&&Object.assign(y,{details:n}),y}return v.status===204?void 0:(v.headers.get("content-type")||"").includes("application/json")?await v.json():await v.text()}const P={async listUsers(r){const o=S("/api/v1/users",r);return z(o,{method:"GET",headers:x()})},async getUserDetail(r){const o=S(`/api/v1/users/${encodeURIComponent(r)}`);return z(o,{method:"GET",headers:x()})},async createUser(r){const o=S("/api/v1/users");return z(o,{method:"POST",headers:x(),body:JSON.stringify(r)})},async assignRoles(r,o){const v=S(`/api/v1/users/${encodeURIComponent(r)}/roles`);return z(v,{method:"POST",headers:x(),body:JSON.stringify({role_ids:o})})},async resetPassword(r){const o=S(`/api/v1/users/${encodeURIComponent(r)}/reset_password`);return z(o,{method:"POST",headers:x()})},async freezeUser(r){const o=S(`/api/v1/users/${encodeURIComponent(r)}/freeze`);return z(o,{method:"POST",headers:x()})},async activateUser(r){const o=S(`/api/v1/users/${encodeURIComponent(r)}/activate`);return z(o,{method:"POST",headers:x()})},async exportUsers(r){const o=S("/api/v1/exports/users");return z(o,{method:"POST",headers:x(),body:JSON.stringify(r||{})})}},ie={async listRoles(){const r=S("/api/v1/roles");return z(r,{method:"GET",headers:x()})},async getRoleDetail(r){const o=S(`/api/v1/roles/${encodeURIComponent(r)}`);return z(o,{method:"GET",headers:x()})},async exportRoles(){const r=S("/api/v1/exports/roles");return z(r,{method:"POST",headers:x(),body:JSON.stringify({})})}},Ie={async getPermissionTree(){const r=S("/api/v1/permissions/tree");return z(r,{method:"GET",headers:x()})}},es={class:"users-roles"},ss={class:"users-roles__header"},ts={class:"users-roles__actions"},as={class:"users-roles__layout"},ls={class:"panel users-panel"},ns={class:"panel__head"},is=["disabled"],rs=["disabled"],os=["value"],us=["disabled"],ds=["value"],cs={class:"filter-form__actions"},ms={class:"user-cell"},ps={class:"user-id"},vs=["data-status"],_s={key:1},fs={class:"panel roles-panel"},ys={class:"panel__head"},gs={class:"role-search"},hs=["disabled"],ks={class:"role-cell"},bs={class:"role-meta"},ws=["data-status"],Us={class:"panel detail-panel"},Rs={key:0,class:"detail-card"},Ts={class:"detail-card__head"},Cs=["data-status"],xs={class:"detail-grid"},Ss={key:1},zs={key:1},$s={class:"detail-card__actions"},Ps={key:0,class:"detail-card__section"},Ds={class:"timeline"},Vs={class:"timeline__time"},Os={class:"timeline__text"},As={key:1,class:"detail-empty"},Ms={key:2,class:"detail-card"},Es={class:"detail-card__head"},js=["data-status"],Ls={class:"detail-grid"},Ns={class:"detail-card__section"},Bs=["aria-busy"],Fs={key:0,class:"permission-placeholder"},Gs={key:3,class:"detail-empty"},qs={key:4,class:"feedback"},Hs={key:5,class:"feedback feedback--error"},Js={class:"checkbox-group"},Ks=["value","checked","onChange"],Qs={class:"checkbox-group"},Ws=["value","checked","onChange"],Xs=ye({__name:"UsersRolesPage",setup(r){const o=b([]),v=b(0),h=b(!1),D=[{user_id:"U1001",name:"张三",phone:"13800000001",email:"zhangsan@example.com",role_ids:["R01","R02"],status:"active",last_login_at:"2025-09-28T12:00:00+08:00",teams:["华南大区","广州一区"]},{user_id:"U1002",name:"李四",phone:"13800000002",email:"lisi@example.com",role_ids:["R03"],status:"frozen",last_login_at:"2025-09-25T09:15:00+08:00",teams:["华东大区"]}],n=W({keyword:"",status:"",role_id:"",page:1,page_size:10,sort_key:"last_login_at",sort_order:"desc"}),w=b([]),y=b(!1),R=b(""),Ue=[{role_id:"R01",name:"组织管理员",desc:"可管理组织架构与用户权限",status:"active",bound_users:18,updated_at:"2025-09-20T09:30:00+08:00"},{role_id:"R02",name:"审核员",desc:"负责订单与提现审核",status:"active",bound_users:32,updated_at:"2025-09-18T14:10:00+08:00"}],re=b([]),Y=b(!1),Re=[{perm_id:"menu:org",name:"组织与用户",type:"menu",children:[{perm_id:"menu:org:teams",name:"团队与人员",type:"menu",children:[]},{perm_id:"menu:org:users",name:"用户与角色",type:"menu",children:[]},{perm_id:"api:/api/v1/users",name:"用户管理接口",type:"api",children:[]}]},{perm_id:"menu:orders",name:"订单与审核",type:"menu",children:[{perm_id:"menu:orders:list",name:"订单列表",type:"menu",children:[]},{perm_id:"api:/api/v1/orders/review",name:"订单审核接口",type:"api",children:[]}]}],$=b(null),A=W({}),Z={U1001:{user_id:"U1001",name:"张三",phone:"13800000001",email:"zhangsan@example.com",role_ids:["R01","R02"],status:"active",last_login_at:"2025-09-28T12:00:00+08:00",teams:["华南大区","广州一区"],created_at:"2024-01-06T08:00:00+08:00",updated_at:"2025-09-25T11:10:00+08:00",recent_actions:[{ts:"2025-09-25T11:00:00+08:00",action:"登录后台"},{ts:"2025-09-24T16:22:00+08:00",action:"审批订单 ORD-223344"}]},U1002:{user_id:"U1002",name:"李四",phone:"13800000002",email:"lisi@example.com",role_ids:["R03"],status:"frozen",last_login_at:"2025-09-25T09:15:00+08:00",teams:["华东大区"],created_at:"2024-03-18T10:00:00+08:00",updated_at:"2025-08-19T10:30:00+08:00",recent_actions:[{ts:"2025-08-01T18:22:00+08:00",action:"导出活动报表"}]}},I=b(null),q=W({}),ee={R01:{role_id:"R01",name:"组织管理员",desc:"可管理组织架构与用户权限",status:"active",bound_users:18,created_at:"2024-01-01T09:00:00+08:00",updated_at:"2025-09-20T09:30:00+08:00",permissions:["menu:org","menu:org:teams","menu:org:users","api:/api/v1/users"]},R02:{role_id:"R02",name:"审核员",desc:"负责订单与提现审核",status:"active",bound_users:32,created_at:"2024-02-10T09:00:00+08:00",updated_at:"2025-09-18T14:10:00+08:00",permissions:["menu:orders","menu:orders:list","api:/api/v1/orders/review"]}},H=b(!1),J=b(!1),f=b(!1),K=b(""),G=b(""),_=W({name:"",phone:"",email:"",role_ids:[]}),L=W({role_ids:[]}),Te=[{value:"active",label:"启用"},{value:"frozen",label:"冻结"},{value:"deleted",label:"已删除"}],Ce=[{key:"name",title:"姓名"},{key:"phone",title:"手机号"},{key:"email",title:"邮箱"},{key:"status",title:"状态"},{key:"roles",title:"角色"},{key:"last_login_at",title:"最近登录",sortable:!0}],xe=[{key:"name",title:"角色"},{key:"status",title:"状态",width:"6rem"},{key:"bound_users",title:"绑定用户",width:"7rem"}],te=M(()=>w.value.filter(s=>s.status==="active")),oe=M(()=>Math.max(1,Math.ceil(v.value/n.page_size))),Se=M(()=>o.value.map(s=>({...s,roles:s.role_ids,role_names:s.role_ids.map(e=>{var p;return((p=w.value.find(l=>l.role_id===e))==null?void 0:p.name)||e})}))),ze=M(()=>{if(!R.value.trim())return w.value;const s=R.value.trim().toLowerCase();return w.value.filter(e=>e.name.toLowerCase().includes(s))}),u=M(()=>$.value&&A[$.value]||null),V=M(()=>I.value&&q[I.value]||null),ue=M(()=>u.value?u.value.role_ids.map(s=>{var e;return((e=w.value.find(p=>p.role_id===s))==null?void 0:e.name)||s}):[]),$e=M(()=>{const s=V.value;if(!s)return[];const e=new Set(s.permissions||[]);return fe(re.value,e)});We(()=>{O(),Pe(),De()});async function O(){var s;h.value=!0;try{const p=await P.listUsers({...n})??{},l=Array.isArray(p.items)?p.items:[];l.length?(o.value=l,v.value=typeof p.total=="number"?p.total:l.length):(o.value=D,v.value=D.length),!$.value&&o.value.length?ce(o.value[0]):$.value&&!o.value.some(a=>a.user_id===$.value)&&($.value=((s=o.value[0])==null?void 0:s.user_id)??null,$.value&&await de($.value))}catch(e){T(e.message||"加载用户失败")}finally{h.value=!1}}async function Pe(){y.value=!0;try{const e=await ie.listRoles()??{};w.value=Array.isArray(e==null?void 0:e.items)&&e.items&&e.items.length?e.items:Ue,!I.value&&w.value.length&&me(w.value[0])}catch(s){T(s.message||"加载角色失败")}finally{y.value=!1}}async function De(){Y.value=!0;try{const e=await Ie.getPermissionTree()??{};re.value=Array.isArray(e==null?void 0:e.items)&&e.items&&e.items.length?e.items:Re}catch(s){T(s.message||"加载权限树失败")}finally{Y.value=!1}}async function de(s){if(!A[s])try{const e=await P.getUserDetail(s);e?A[s]=e:Z[s]&&(A[s]=Z[s])}catch(e){Z[s]?A[s]=Z[s]:T(e.message||"获取用户详情失败")}}async function Ve(s){if(!q[s])try{const e=await ie.getRoleDetail(s);e?q[s]=e:ee[s]&&(q[s]=ee[s])}catch(e){ee[s]?q[s]=ee[s]:T(e.message||"获取角色详情失败")}}function Oe(){n.page=1,O()}function Ae(){n.keyword="",n.status="",n.role_id="",n.page=1,n.page_size=10,n.sort_key="last_login_at",n.sort_order="desc",O()}function Me(s,e){(s==="last_login_at"||s==="name")&&(n.sort_key=s,n.sort_order=e,O())}function Ee(s){n.page=s,O()}function je(s){n.page_size=s,n.page=1,O()}async function ce(s){$.value=s.user_id,await de(s.user_id)}async function me(s){I.value=s.role_id,await Ve(s.role_id)}function Le(){_.name="",_.phone="",_.email="",_.role_ids=[],H.value=!0}function Ne(s,e){e.target.checked?_.role_ids.includes(s)||_.role_ids.push(s):_.role_ids=_.role_ids.filter(l=>l!==s)}function Be(){u.value&&(L.role_ids=[...u.value.role_ids],J.value=!0)}function Fe(s,e){e.target.checked?L.role_ids.includes(s)||L.role_ids.push(s):L.role_ids=L.role_ids.filter(l=>l!==s)}async function pe(){var s,e;if(!_.name.trim()){T("请填写姓名");return}f.value=!0;try{const p={name:_.name.trim(),phone:((s=_.phone)==null?void 0:s.trim())||void 0,email:((e=_.email)==null?void 0:e.trim())||void 0,role_ids:[..._.role_ids]},l=await P.createUser(p);A[l.user.user_id]=l.user,N(`已创建用户 ${l.user.name}${l.temporary_password?`，临时密码：${l.temporary_password}`:""}`),H.value=!1,$.value=l.user.user_id,await O()}catch(p){T(p.message||"创建用户失败")}finally{f.value=!1}}async function ve(){if(u.value){f.value=!0;try{const s=[...L.role_ids];await P.assignRoles(u.value.user_id,s);const e=await P.getUserDetail(u.value.user_id);A[u.value.user_id]=e,N("角色已更新"),J.value=!1,await O()}catch(s){T(s.message||"分配角色失败")}finally{f.value=!1}}}async function Ge(){if(u.value){f.value=!0;try{const s=await P.resetPassword(u.value.user_id);N(`已重置密码：${s.temp_password}`)}catch(s){T(s.message||"重置密码失败")}finally{f.value=!1}}}async function qe(){if(u.value){f.value=!0;try{u.value.status==="frozen"?(await P.activateUser(u.value.user_id),N("用户已解除冻结")):(await P.freezeUser(u.value.user_id),N("用户已冻结"));const s=await P.getUserDetail(u.value.user_id);A[u.value.user_id]=s,await O()}catch(s){T(s.message||"更新用户状态失败")}finally{f.value=!1}}}async function He(){f.value=!0;try{const s=await P.exportUsers({...n});N(`用户导出任务：${s.export_id}`)}catch(s){T(s.message||"导出用户失败")}finally{f.value=!1}}async function Je(){f.value=!0;try{const s=await ie.exportRoles();N(`角色导出任务：${s.export_id}`)}catch(s){T(s.message||"导出角色失败")}finally{f.value=!1}}function _e(s){switch(s){case"active":return"启用";case"frozen":return"冻结";case"deleted":return"已删除";default:return s}}function Q(s){if(!s)return"—";const e=new Date(s);return Number.isNaN(e.getTime())?s:`${e.toLocaleDateString()} ${e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`}function fe(s,e){return s.map(p=>{const l=fe(p.children||[],e),a=l.filter(le=>le.checked).length,U=l.some(le=>le.indeterminate),ae=e.has(p.perm_id)||a===l.length,Qe=!ae&&(a>0||U)||ae&&(U||l.length>0&&a!==l.length);return{...p,checked:ae,indeterminate:Qe,children:l}})}function N(s){K.value=s,G.value="",window.setTimeout(()=>{K.value===s&&(K.value="")},4e3)}function T(s){G.value=s,window.setTimeout(()=>{G.value===s&&(G.value="")},5e3)}const Ke=ye({name:"PermissionTree",props:{nodes:{type:Array,default:()=>[]}},setup(s){const e=p=>p.map(l=>{const a=l.checked?"is-checked":l.indeterminate?"is-mixed":"is-unchecked",U=[];return U.push(F("div",{class:"perm-item",role:"checkbox","aria-checked":l.indeterminate?"mixed":l.checked?"true":"false"},[F("span",{class:["perm-indicator",a]}),F("span",{class:"perm-name"},l.name),F("span",{class:"perm-tag","data-type":l.type},l.type==="menu"?"菜单":"接口")])),l.children&&l.children.length&&U.push(F("ul",{class:"perm-list"},e(l.children))),F("li",{key:l.perm_id},U)});return()=>F("ul",{class:"perm-list"},e(s.nodes))}});return(s,e)=>{var p,l;return d(),c("section",es,[t("header",ss,[e[15]||(e[15]=t("div",null,[t("h1",{class:"users-roles__title"},"用户与角色"),t("p",{class:"users-roles__subtitle"}," 管理系统账号、角色与权限，保障分级管控与合规。 ")],-1)),t("div",ts,[k(C,{size:"sm",variant:"ghost",disabled:h.value||y.value,onClick:Je},{default:m(()=>[...e[13]||(e[13]=[g("导出角色",-1)])]),_:1},8,["disabled"]),k(C,{size:"sm",variant:"ghost",disabled:h.value,onClick:He},{default:m(()=>[...e[14]||(e[14]=[g("导出用户",-1)])]),_:1},8,["disabled"])])]),t("div",as,[t("aside",ls,[t("header",ns,[t("div",null,[e[16]||(e[16]=t("h2",null,"用户列表",-1)),t("p",null,"共 "+i(v.value)+" 人",1)]),k(C,{size:"sm",variant:"primary",onClick:Le},{default:m(()=>[...e[17]||(e[17]=[g("新建用户",-1)])]),_:1})]),t("form",{class:"filter-form",onSubmit:ne(Oe,["prevent"])},[t("label",null,[e[18]||(e[18]=t("span",null,"关键词",-1)),B(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>n.keyword=a),type:"search",placeholder:"姓名 / 手机 / 邮箱",disabled:h.value},null,8,is),[[X,n.keyword,void 0,{trim:!0}]])]),t("label",null,[e[20]||(e[20]=t("span",null,"状态",-1)),B(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>n.status=a),disabled:h.value},[e[19]||(e[19]=t("option",{value:""},"全部",-1)),(d(),c(E,null,j(Te,a=>t("option",{key:a.value,value:a.value},i(a.label),9,os)),64))],8,rs),[[ge,n.status]])]),t("label",null,[e[22]||(e[22]=t("span",null,"角色",-1)),B(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>n.role_id=a),disabled:h.value},[e[21]||(e[21]=t("option",{value:""},"全部",-1)),(d(!0),c(E,null,j(te.value,a=>(d(),c("option",{key:a.role_id,value:a.role_id},i(a.name),9,ds))),128))],8,us),[[ge,n.role_id]])]),t("div",cs,[k(C,{size:"sm",type:"submit",loading:h.value},{default:m(()=>[...e[23]||(e[23]=[g("应用",-1)])]),_:1},8,["loading"]),k(C,{size:"sm",variant:"ghost",type:"button",onClick:Ae,disabled:h.value},{default:m(()=>[...e[24]||(e[24]=[g("重置",-1)])]),_:1},8,["disabled"])])],32),k(be,{columns:Ce,rows:Se.value,loading:h.value,"row-key":a=>a.user_id,"default-sort-key":"last_login_at","default-sort-order":"desc",onRowClick:ce,onSortChange:Me},{"cell:name":m(({row:a})=>[t("div",ms,[t("strong",null,i(a.name),1),t("span",ps,i(a.user_id),1)])]),"cell:status":m(({row:a})=>[t("span",{class:"status-chip","data-status":a.status},i(_e(a.status)),9,vs)]),"cell:roles":m(({row:a})=>[a.role_names.length?(d(!0),c(E,{key:0},j(a.role_names,U=>(d(),c("span",{class:"role-badge",key:`${a.user_id}-${U}`},i(U),1))),128)):(d(),c("span",_s,"—"))]),"cell:last_login_at":m(({row:a})=>[g(i(Q(a.last_login_at)),1)]),empty:m(()=>[g(i(h.value?"加载中…":"暂无用户"),1)]),pagination:m(()=>[oe.value>1?(d(),he(Ze,{key:0,page:n.page,pages:oe.value,"page-size":n.page_size,"onUpdate:page":Ee,"onUpdate:pageSize":je},null,8,["page","pages","page-size"])):se("",!0)]),_:1},8,["rows","loading","row-key"])]),t("aside",fs,[t("header",ys,[t("div",null,[e[25]||(e[25]=t("h2",null,"角色列表",-1)),t("p",null,"共 "+i(w.value.length)+" 个",1)])]),t("label",gs,[e[26]||(e[26]=t("span",null,"搜索角色",-1)),B(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>R.value=a),type:"search",placeholder:"角色名",disabled:y.value},null,8,hs),[[X,R.value,void 0,{trim:!0}]])]),k(be,{columns:xe,rows:ze.value,loading:y.value,"row-key":a=>a.role_id,onRowClick:me},{"cell:name":m(({row:a})=>[t("div",ks,[t("strong",null,i(a.name),1),t("span",bs,i(a.desc||"—"),1)])]),"cell:status":m(({row:a})=>[t("span",{class:"status-chip","data-status":a.status==="active"?"active":"archived"},i(a.status==="active"?"启用":"已归档"),9,ws)]),empty:m(()=>[g(i(y.value?"加载中…":"暂无角色"),1)]),_:1},8,["rows","loading","row-key"])]),t("section",Us,[u.value?(d(),c("article",Rs,[t("header",Ts,[t("div",null,[t("h3",null,i(u.value.name),1),t("p",null,i(u.value.email||"—"),1)]),t("span",{class:"status-chip","data-status":u.value.status},i(_e(u.value.status)),9,Cs)]),t("dl",xs,[t("div",null,[e[27]||(e[27]=t("dt",null,"手机号",-1)),t("dd",null,i(u.value.phone||"—"),1)]),t("div",null,[e[28]||(e[28]=t("dt",null,"最近登录",-1)),t("dd",null,i(Q(u.value.last_login_at)),1)]),t("div",null,[e[29]||(e[29]=t("dt",null,"所属团队",-1)),t("dd",null,[(p=u.value.teams)!=null&&p.length?(d(!0),c(E,{key:0},j(u.value.teams,a=>(d(),c("span",{key:a,class:"tag-chip"},i(a),1))),128)):(d(),c("span",Ss,"—"))])]),t("div",null,[e[30]||(e[30]=t("dt",null,"分配角色",-1)),t("dd",null,[ue.value.length?(d(!0),c(E,{key:0},j(ue.value,a=>(d(),c("span",{key:a,class:"tag-chip tag-chip--primary"},i(a),1))),128)):(d(),c("span",zs,"—"))])])]),t("div",$s,[k(C,{size:"sm",variant:"secondary",onClick:Be,disabled:f.value},{default:m(()=>[...e[31]||(e[31]=[g("分配角色",-1)])]),_:1},8,["disabled"]),k(C,{size:"sm",variant:"secondary",onClick:Ge,disabled:f.value},{default:m(()=>[...e[32]||(e[32]=[g("重置密码",-1)])]),_:1},8,["disabled"]),k(C,{size:"sm",variant:"danger",disabled:u.value.status==="deleted"||f.value,onClick:qe},{default:m(()=>[g(i(u.value.status==="frozen"?"解除冻结":"冻结用户"),1)]),_:1},8,["disabled"])]),(l=u.value.recent_actions)!=null&&l.length?(d(),c("section",Ps,[e[33]||(e[33]=t("h4",null,"最近操作",-1)),t("ul",Ds,[(d(!0),c(E,null,j(u.value.recent_actions,a=>(d(),c("li",{key:a.ts},[t("span",Vs,i(Q(a.ts)),1),t("span",Os,i(a.action),1)]))),128))])])):se("",!0)])):(d(),c("article",As," 请选择左侧用户查看详情 ")),V.value?(d(),c("article",Ms,[t("header",Es,[t("div",null,[t("h3",null,i(V.value.name),1),t("p",null,i(V.value.desc||"—"),1)]),t("span",{class:"status-chip","data-status":V.value.status==="active"?"active":"archived"},i(V.value.status==="active"?"启用":"已归档"),9,js)]),t("dl",Ls,[t("div",null,[e[34]||(e[34]=t("dt",null,"绑定用户",-1)),t("dd",null,i(V.value.bound_users??0)+" 人",1)]),t("div",null,[e[35]||(e[35]=t("dt",null,"创建时间",-1)),t("dd",null,i(Q(V.value.created_at)),1)]),t("div",null,[e[36]||(e[36]=t("dt",null,"最近更新",-1)),t("dd",null,i(Q(V.value.updated_at)),1)])]),t("section",Ns,[e[37]||(e[37]=t("h4",null,"权限树",-1)),t("div",{class:"permission-tree","aria-busy":Y.value?"true":"false"},[Y.value?(d(),c("p",Fs,"加载权限树…")):(d(),he(Xe(Ke),{key:1,nodes:$e.value},null,8,["nodes"]))],8,Bs)])])):(d(),c("article",Gs," 请选择角色查看权限 ")),K.value?(d(),c("p",qs,i(K.value),1)):se("",!0),G.value?(d(),c("p",Hs,i(G.value),1)):se("",!0)])]),k(ke,{modelValue:H.value,"onUpdate:modelValue":e[9]||(e[9]=a=>H.value=a),onConfirm:pe},{title:m(()=>[...e[38]||(e[38]=[g("新建用户",-1)])]),footer:m(()=>[k(C,{variant:"secondary",onClick:e[8]||(e[8]=a=>H.value=!1),disabled:f.value},{default:m(()=>[...e[43]||(e[43]=[g("取消",-1)])]),_:1},8,["disabled"]),k(C,{variant:"primary",loading:f.value,onClick:pe},{default:m(()=>[...e[44]||(e[44]=[g("创建",-1)])]),_:1},8,["loading"])]),default:m(()=>[t("form",{class:"modal-form",onSubmit:e[7]||(e[7]=ne(()=>{},["prevent"]))},[t("label",null,[e[39]||(e[39]=t("span",null,"姓名",-1)),B(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>_.name=a),type:"text",placeholder:"请输入姓名",required:""},null,512),[[X,_.name,void 0,{trim:!0}]])]),t("label",null,[e[40]||(e[40]=t("span",null,"手机号",-1)),B(t("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>_.phone=a),type:"tel",placeholder:"13800000000"},null,512),[[X,_.phone,void 0,{trim:!0}]])]),t("label",null,[e[41]||(e[41]=t("span",null,"邮箱",-1)),B(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>_.email=a),type:"email",placeholder:"name@example.com"},null,512),[[X,_.email,void 0,{trim:!0}]])]),t("fieldset",Js,[e[42]||(e[42]=t("legend",null,"分配角色",-1)),(d(!0),c(E,null,j(te.value,a=>(d(),c("label",{key:`create-${a.role_id}`,class:"checkbox"},[t("input",{type:"checkbox",value:a.role_id,checked:_.role_ids.includes(a.role_id),onChange:U=>Ne(a.role_id,U)},null,40,Ks),t("span",null,i(a.name),1)]))),128))])],32)]),_:1},8,["modelValue"]),k(ke,{modelValue:J.value,"onUpdate:modelValue":e[12]||(e[12]=a=>J.value=a),onConfirm:ve},{title:m(()=>[...e[45]||(e[45]=[g("分配角色",-1)])]),footer:m(()=>[k(C,{variant:"secondary",onClick:e[11]||(e[11]=a=>J.value=!1),disabled:f.value},{default:m(()=>[...e[47]||(e[47]=[g("取消",-1)])]),_:1},8,["disabled"]),k(C,{variant:"primary",loading:f.value,onClick:ve},{default:m(()=>[...e[48]||(e[48]=[g("保存",-1)])]),_:1},8,["loading"])]),default:m(()=>[t("form",{class:"modal-form",onSubmit:e[10]||(e[10]=ne(()=>{},["prevent"]))},[t("fieldset",Qs,[e[46]||(e[46]=t("legend",null,"可用角色",-1)),(d(!0),c(E,null,j(te.value,a=>(d(),c("label",{key:`assign-${a.role_id}`,class:"checkbox"},[t("input",{type:"checkbox",value:a.role_id,checked:L.role_ids.includes(a.role_id),onChange:U=>Fe(a.role_id,U)},null,40,Ws),t("span",null,i(a.name),1)]))),128))])],32)]),_:1},8,["modelValue"])])}}}),at=Ye(Xs,[["__scopeId","data-v-103e7457"]]);export{at as default};
