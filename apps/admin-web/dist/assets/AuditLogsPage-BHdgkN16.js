import{O as pe,d as $e,a as R,r as q,c as F,o as Ce,b,e as t,f as $,A as T,B as c,t as o,i as m,v as C,j as G,H as ue,F as ze,h as Ie,n as ce,k as J,q as g,s as k,E as Ue,_ as Ve}from"./index-DvtP9USg.js";import{B as z}from"./Button-BaguUGDy.js";import{P as De}from"./Pagination-3ermIvaY.js";import{T as Pe}from"./Table-BsZuLW91.js";function M(){return{"Content-Type":"application/json",...pe.HEADERS||{}}}function N(p,d){var _;const u=((_=pe.BASE)==null?void 0:_.replace(/\/$/,""))||"";if(!d||Object.keys(d).length===0)return`${u}${p}`;const A=new URLSearchParams;Object.entries(d).forEach(([w,f])=>{if(!(f==null||f==="")){if(Array.isArray(f)){f.length&&A.append(w,f.join(","));return}A.append(w,String(f))}});const a=A.toString();return a?`${u}${p}?${a}`:`${u}${p}`}async function O(p,d){const u=await fetch(p,d);if(!u.ok){let a=`Request failed with ${u.status}`,_=null;const w=u.headers.get("content-type")||"";try{if(w.includes("application/json")){_=await u.json();const n=_==null?void 0:_.message;typeof n=="string"&&n.trim()&&(a=n)}else{const n=await u.text();n.trim()&&(a=n)}}catch{}const f=new Error(a);throw _&&typeof _=="object"&&Object.assign(f,{details:_}),f}return u.status===204?void 0:(u.headers.get("content-type")||"").includes("application/json")?await u.json():await u.text()}const V={async list(p){const d=N("/api/v1/audit/events",p||{});return O(d,{method:"GET",headers:M()})},async get(p){const d=N(`/api/v1/audit/events/${encodeURIComponent(p)}`);return O(d,{method:"GET",headers:M()})},async verify(p){const d=N("/api/v1/audit/verify",p);return O(d,{method:"GET",headers:M()})},async createEvidence(p){const d=N("/api/v1/audit/evidence");return O(d,{method:"POST",headers:M(),body:JSON.stringify(p)})}},He={class:"audit-logs"},je={class:"audit-logs__header"},Re={class:"audit-logs__actions"},qe={class:"audit-logs__stats"},Me={class:"stats-card"},Ne={class:"stats-card__value"},Oe={class:"stats-card"},Le={class:"stats-card__value"},Be={class:"stats-card"},Fe={class:"stats-card__value"},Ge={class:"stats-card"},Je={class:"stats-card__value"},We={class:"filters__group"},Ye={class:"filters__grid"},Qe={class:"filters__field"},Ke=["disabled"],Xe={class:"filters__field"},Ze=["disabled"],et={class:"filters__field"},tt=["disabled"],st={class:"filters__field"},at=["disabled"],lt={class:"filters__field"},nt=["disabled"],it={class:"filters__field"},ot=["disabled"],rt={class:"filters__field"},dt=["disabled"],ut={class:"filters__field"},ct=["disabled"],pt={class:"filters__field"},vt=["disabled"],_t={class:"filters__field"},ft=["disabled"],gt={class:"filters__actions"},yt={class:"quick-range"},bt=["disabled","onClick"],mt={class:"filters__buttons"},ht={class:"audit-logs__table"},kt={class:"type-badge"},wt={class:"cell-multi"},xt={class:"cell-multi"},St=["data-result"],Tt={class:"cell-multi"},At={class:"muted"},Et=["data-valid"],$t={class:"row-actions"},Ct=["onClick"],zt=["onClick"],It={key:0,class:"event-drawer"},Ut={class:"event-drawer__header"},Vt={key:0,class:"event-drawer__body"},Dt={key:1,class:"event-drawer__body"},Pt={class:"drawer-section"},Ht={class:"drawer-grid"},jt=["data-valid"],Rt={class:"drawer-buttons"},qt={key:0,class:"drawer-section"},Mt={class:"chain-list"},Nt={key:0},Ot={key:1},Lt={class:"drawer-section"},Bt={class:"drawer-pre"},Ft={key:1,class:"drawer-section"},Gt={class:"drawer-pre"},Jt={key:2,class:"event-drawer__body"},Wt=$e({__name:"AuditLogsPage",setup(p){const d=new Date,u=P(d),A=P(j(d,-24)),a=R({start:A,end:u,level:"",type:"",result:"",source:"",actor:"",resourceType:"",resourceId:"",ip:"",page:1,pageSize:50}),_=[{value:"24h",label:"近 24 小时"},{value:"7d",label:"近 7 天"},{value:"30d",label:"近 30 天"}],w=q("24h"),f=[{key:"ts",title:"时间",width:"12rem"},{key:"type",title:"事件类型",width:"10rem"},{key:"actor",title:"主体",width:"12rem"},{key:"resource",title:"资源",width:"11rem"},{key:"result",title:"结果",width:"6rem"},{key:"ip",title:"IP / UA",width:"12rem"},{key:"trace_id",title:"Trace ID",width:"12rem"},{key:"signature",title:"签名",width:"6rem"},{key:"actions",title:"操作",width:"8rem"}],n=R({list:!1,detail:!1,verify:!1,evidence:!1}),I=q([]),L=q(0),D=R({open:!1,eventId:""}),i=q(null),x=R({message:"",error:!1}),B={total:4,page:1,page_size:50,items:[{event_id:"A202510030001",ts:"2025-10-03T10:00:12+08:00",level:"security",type:"export_download",actor:{user_id:"U1001",name:"李想",roles:["finance"],org_id:"ORG-01"},source:"web",resource:{type:"export",id:"E20251003002"},action:"download",result:"fail",reason:"signature expired",ip:"203.0.113.10",ua:"Chrome/140",trace_id:"tr-9abcde",signature:{algo:"SHA256",hash:"abc123",prev_hash:"def456",chain_ok:!0}},{event_id:"A202510030002",ts:"2025-10-03T09:45:33+08:00",level:"info",type:"login_success",actor:{user_id:"U2002",name:"王晴",roles:["security_admin"]},source:"web",resource:{type:"user",id:"U2002"},action:"login",result:"success",ip:"198.51.100.24",ua:"Safari/17",trace_id:"tr-abcdef",signature:{algo:"SHA256",hash:"ghi789",prev_hash:"jkl012",chain_ok:!0}},{event_id:"A202510030003",ts:"2025-10-03T09:32:05+08:00",level:"warn",type:"permission_change",actor:{user_id:"U2001",name:"陈惠",roles:["admin"]},source:"web",resource:{type:"role",id:"auditor"},action:"grant",result:"success",ip:"203.0.113.42",ua:"Edge/119",trace_id:"tr-77ab999",signature:{algo:"SHA256",hash:"mno345",prev_hash:"pqr678",chain_ok:!0}},{event_id:"A202510030004",ts:"2025-10-03T09:15:20+08:00",level:"security",type:"wallet_export",actor:{user_id:"U3001",name:"赵越",roles:["finance"]},source:"api",resource:{type:"wallet",id:"WLT-8899"},action:"export",result:"success",ip:"192.0.2.20",ua:"API Client/2.5",trace_id:"tr-5566aa",signature:{algo:"SHA256",hash:"stu901",prev_hash:"vwx234",chain_ok:!1}}]},W={event_id:"A202510030001",ts:"2025-10-03T10:00:12+08:00",level:"security",type:"export_download",actor:{user_id:"U1001",name:"李想",roles:["finance"],org_id:"ORG-01"},source:"web",resource:{type:"export",id:"E20251003002"},action:"download",result:"fail",reason:"signature expired",ip:"203.0.113.10",ua:"Chrome/140",trace_id:"tr-9abcde",signature:{algo:"SHA256",hash:"abc123",prev_hash:"def456",chain_ok:!0},redactions:["extra.token"],extra:{params_hash:"9f178d",download_url:"https://mock/exports/E20251003002?sig=expired",token:"***"},chain:{prev:{event_id:"A202510030000",ts:"2025-10-03T09:58:00+08:00",hash:"def456"},next:{event_id:"A202510030002",ts:"2025-10-03T10:05:00+08:00",hash:"ghi789"}},context:{http:{method:"GET",path:"/api/v1/exports/E20251003002/download",query:"expires=1696300000&signature=***"}}},Y={ok:!0,first_hash:"abc000",last_hash:"xyz999",broken_links:[]},Q=F(()=>I.value),K=F(()=>Math.max(1,Math.ceil(L.value/a.pageSize))),H=F(()=>{let s=0,e=0,r=0;return Q.value.forEach(h=>{var U;h.result==="fail"&&(s+=1),h.level==="security"&&(e+=1),(U=h.type)!=null&&U.includes("export")&&(r+=1)}),{total:Q.value.length,failed:s,security:e,export:r}});Ce(()=>{E()});async function E(){n.list=!0;try{const s=await V.list(Te()),e=s&&Array.isArray(s.items)&&s.items.length?s:B;I.value=e.items,L.value=typeof e.total=="number"?e.total:e.items.length}catch(s){I.value=B.items,L.value=B.total,v(s.message||"加载审计事件失败，展示示例数据。",!0)}finally{n.list=!1}}async function ve(s){n.detail=!0;try{const e=await V.get(s);i.value=e??W}catch(e){i.value=W,v(e.message||"获取事件详情失败。",!0)}finally{n.detail=!1}}function _e(){a.page=1,E()}function fe(){a.start=A,a.end=u,a.level="",a.type="",a.result="",a.source="",a.actor="",a.resourceType="",a.resourceId="",a.ip="",a.page=1,a.pageSize=50,w.value="24h",E()}function ge(s){w.value=s,s==="24h"?(a.start=P(j(d,-24)),a.end=u):s==="7d"?(a.start=P(j(d,-24*7)),a.end=u):(a.start=P(j(d,-24*30)),a.end=u),a.page=1,E()}function ye(s){a.page=s,E()}function be(s){a.pageSize=s,a.page=1,E()}function X(s){D.open=!0,D.eventId=s.event_id,i.value=s,ve(s.event_id)}function me(){D.open=!1,D.eventId="",i.value=null}async function he(){var s,e;if(i.value){n.verify=!0;try{const r={from:i.value.chain&&((s=i.value.chain.prev)==null?void 0:s.event_id),to:i.value.chain&&((e=i.value.chain.next)==null?void 0:e.event_id)};(await V.verify(r)??Y).ok?v("链验证通过。",!1):v("链验证失败，请检查断点。",!0)}catch(r){v(r.message||"链验证请求失败。",!0)}finally{n.verify=!1}}}async function ke(s){n.verify=!0;try{(await V.verify({from:s.event_id,to:s.event_id})??Y).ok?v(`事件 ${s.event_id} 链一致。`,!1):v(`事件 ${s.event_id} 链异常。`,!0)}catch(e){v(e.message||"链验证失败。",!0)}finally{n.verify=!1}}async function we(){if(i.value){n.evidence=!0;try{const e=await V.createEvidence({event_ids:[i.value.event_id],include_context:!0})??{package_id:"EV20251003001",download_url:"https://mock/audit/evidence/EV20251003001.zip"};v(`取证包已生成（${e.package_id}），请下载。`,!1)}catch(s){v(s.message||"取证打包失败。",!0)}finally{n.evidence=!1}}}async function xe(){if(!I.value.length){v("当前无可导出的事件。",!0);return}n.evidence=!0;try{const s=I.value.slice(0,3).map(h=>h.event_id),r=await V.createEvidence({event_ids:s,include_context:!1})??{package_id:"EV20251003002",download_url:"https://mock/audit/evidence/EV20251003002.zip"};v(`取证包 ${r.package_id} 已生成。`,!1)}catch(s){v(s.message||"取证打包失败。",!0)}finally{n.evidence=!1}}function Se(){var s,e,r;(e=(s=i.value)==null?void 0:s.signature)!=null&&e.hash&&((r=navigator.clipboard)==null||r.writeText(i.value.signature.hash).then(()=>v("哈希已复制。",!1),()=>v("复制失败，请手动复制。",!0)))}function Te(){return{start:a.start||void 0,end:a.end||void 0,level:a.level||void 0,type:a.type||void 0,result:a.result||void 0,source:a.source||void 0,actor:a.actor||void 0,resource_type:a.resourceType||void 0,resource_id:a.resourceId||void 0,ip:a.ip||void 0,page:a.page,page_size:a.pageSize}}function v(s,e){x.message=s,x.error=e,s&&window.setTimeout(()=>{x.message===s&&(x.message="",x.error=!1)},e?5e3:3e3)}function Z(s){if(!s)return"—";const e=new Date(s);return Number.isNaN(e.getTime())?s:`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`}function Ae(s){return{info:"信息",warn:"警告",error:"错误",security:"安全"}[s]||s}function ee(s){return s==="success"?"成功":s==="fail"?"失败":s}function Ee(s){return{web:"Web",api:"API",cron:"定时任务",rpa:"RPA",callback:"回调"}[s]||s}function te(s){try{return JSON.stringify(s,null,2)}catch{return String(s)}}function P(s){const e=r=>String(r).padStart(2,"0");return`${s.getFullYear()}-${e(s.getMonth()+1)}-${e(s.getDate())}T${e(s.getHours())}:${e(s.getMinutes())}`}function j(s,e){const r=new Date(s);return r.setHours(r.getHours()+e),r}return(s,e)=>{var r,h,U,se,ae,le,ne,ie,oe,re;return g(),b("section",He,[t("header",je,[e[12]||(e[12]=t("div",null,[t("h1",{class:"audit-logs__title"},"审计日志"),t("p",{class:"audit-logs__subtitle"},"检索关键操作事件，追踪签名链并快速取证。")],-1)),t("div",Re,[T(z,{size:"sm",variant:"ghost",disabled:n.list,onClick:E},{default:c(()=>[...e[10]||(e[10]=[k("刷新",-1)])]),_:1},8,["disabled"]),T(z,{size:"sm",disabled:n.list,onClick:xe},{default:c(()=>[...e[11]||(e[11]=[k("取证打包",-1)])]),_:1},8,["disabled"])])]),t("section",qe,[t("article",Me,[e[13]||(e[13]=t("span",{class:"stats-card__label"},"事件总数",-1)),t("strong",Ne,o(H.value.total),1)]),t("article",Oe,[e[14]||(e[14]=t("span",{class:"stats-card__label"},"失败事件",-1)),t("strong",Le,o(H.value.failed),1)]),t("article",Be,[e[15]||(e[15]=t("span",{class:"stats-card__label"},"安全级别",-1)),t("strong",Fe,o(H.value.security),1)]),t("article",Ge,[e[16]||(e[16]=t("span",{class:"stats-card__label"},"导出相关",-1)),t("strong",Je,o(H.value.export),1)])]),t("form",{class:"audit-logs__filters",onSubmit:J(_e,["prevent"])},[t("fieldset",We,[e[33]||(e[33]=t("legend",{class:"sr-only"},"筛选条件",-1)),t("div",Ye,[t("label",Qe,[e[17]||(e[17]=t("span",null,"开始时间",-1)),m(t("input",{type:"datetime-local","onUpdate:modelValue":e[0]||(e[0]=l=>a.start=l),disabled:n.list},null,8,Ke),[[C,a.start]])]),t("label",Xe,[e[18]||(e[18]=t("span",null,"结束时间",-1)),m(t("input",{type:"datetime-local","onUpdate:modelValue":e[1]||(e[1]=l=>a.end=l),disabled:n.list},null,8,Ze),[[C,a.end]])]),t("label",et,[e[20]||(e[20]=t("span",null,"级别",-1)),m(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>a.level=l),disabled:n.list},[...e[19]||(e[19]=[ue('<option value="" data-v-12b98967>全部</option><option value="info" data-v-12b98967>信息</option><option value="warn" data-v-12b98967>警告</option><option value="error" data-v-12b98967>错误</option><option value="security" data-v-12b98967>安全</option>',5)])],8,tt),[[G,a.level]])]),t("label",st,[e[21]||(e[21]=t("span",null,"事件类型",-1)),m(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=l=>a.type=l),placeholder:"如 export_download",disabled:n.list},null,8,at),[[C,a.type,void 0,{trim:!0}]])]),t("label",lt,[e[23]||(e[23]=t("span",null,"结果",-1)),m(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>a.result=l),disabled:n.list},[...e[22]||(e[22]=[t("option",{value:""},"全部",-1),t("option",{value:"success"},"成功",-1),t("option",{value:"fail"},"失败",-1)])],8,nt),[[G,a.result]])]),t("label",it,[e[25]||(e[25]=t("span",null,"来源",-1)),m(t("select",{"onUpdate:modelValue":e[5]||(e[5]=l=>a.source=l),disabled:n.list},[...e[24]||(e[24]=[ue('<option value="" data-v-12b98967>全部</option><option value="web" data-v-12b98967>Web</option><option value="api" data-v-12b98967>API</option><option value="cron" data-v-12b98967>定时任务</option><option value="rpa" data-v-12b98967>RPA</option><option value="callback" data-v-12b98967>回调</option>',6)])],8,ot),[[G,a.source]])]),t("label",rt,[e[26]||(e[26]=t("span",null,"主体/用户",-1)),m(t("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=l=>a.actor=l),placeholder:"用户 ID",disabled:n.list},null,8,dt),[[C,a.actor,void 0,{trim:!0}]])]),t("label",ut,[e[27]||(e[27]=t("span",null,"资源类型",-1)),m(t("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=l=>a.resourceType=l),placeholder:"如 export",disabled:n.list},null,8,ct),[[C,a.resourceType,void 0,{trim:!0}]])]),t("label",pt,[e[28]||(e[28]=t("span",null,"资源 ID",-1)),m(t("input",{type:"text","onUpdate:modelValue":e[8]||(e[8]=l=>a.resourceId=l),placeholder:"ID",disabled:n.list},null,8,vt),[[C,a.resourceId,void 0,{trim:!0}]])]),t("label",_t,[e[29]||(e[29]=t("span",null,"IP",-1)),m(t("input",{type:"text","onUpdate:modelValue":e[9]||(e[9]=l=>a.ip=l),placeholder:"203.0.113.10",disabled:n.list},null,8,ft),[[C,a.ip,void 0,{trim:!0}]])])]),t("div",gt,[t("div",yt,[e[30]||(e[30]=t("span",null,"快速选择：",-1)),(g(),b(ze,null,Ie(_,l=>t("button",{key:l.value,type:"button",class:ce(["quick-range__btn",{"is-active":w.value===l.value}]),disabled:n.list,onClick:y=>ge(l.value)},o(l.label),11,bt)),64))]),t("div",mt,[T(z,{size:"sm",type:"submit",loading:n.list},{default:c(()=>[...e[31]||(e[31]=[k("应用",-1)])]),_:1},8,["loading"]),T(z,{size:"sm",variant:"ghost",type:"button",disabled:n.list,onClick:fe},{default:c(()=>[...e[32]||(e[32]=[k("重置",-1)])]),_:1},8,["disabled"])])])])],32),t("section",ht,[T(Pe,{columns:f,rows:I.value,loading:n.list,"row-key":l=>l.event_id,"default-sort-key":"ts","default-sort-order":"desc",onRowClick:X},{"cell:ts":c(({row:l})=>[k(o(Z(l.ts)),1)]),"cell:type":c(({row:l})=>[t("span",kt,o(l.type),1)]),"cell:actor":c(({row:l})=>{var y,S,de;return[t("div",wt,[t("strong",null,o(((y=l.actor)==null?void 0:y.name)||((S=l.actor)==null?void 0:S.user_id)||"—"),1),t("span",null,o((((de=l.actor)==null?void 0:de.roles)||[]).join(", ")||"无角色"),1)])]}),"cell:resource":c(({row:l})=>{var y,S;return[t("div",xt,[t("strong",null,o(((y=l.resource)==null?void 0:y.type)||"—"),1),t("span",null,o(((S=l.resource)==null?void 0:S.id)||"—"),1)])]}),"cell:result":c(({row:l})=>[t("span",{class:"result-chip","data-result":l.result},o(ee(l.result)),9,St)]),"cell:ip":c(({row:l})=>[t("div",Tt,[t("span",null,o(l.ip||"—"),1),t("span",At,o(l.ua||"—"),1)])]),"cell:signature":c(({row:l})=>{var y,S;return[t("span",{class:"signature-chip","data-valid":((y=l.signature)==null?void 0:y.chain_ok)===!0},o((S=l.signature)!=null&&S.chain_ok?"完整":"异常"),9,Et)]}),"cell:actions":c(({row:l})=>[t("div",$t,[t("button",{type:"button",class:"link-btn",onClick:J(y=>X(l),["stop"])},"详情",8,Ct),t("button",{type:"button",class:"link-btn",onClick:J(y=>ke(l),["stop"])},"验证",8,zt)])]),empty:c(()=>[k(o(n.list?"加载审计事件中…":"暂无记录，请调整筛选条件。"),1)]),pagination:c(()=>[K.value>1?(g(),Ue(De,{key:0,page:a.page,pages:K.value,"page-size":a.pageSize,"onUpdate:page":ye,"onUpdate:pageSize":be},null,8,["page","pages","page-size"])):$("",!0)]),_:1},8,["rows","loading","row-key"])]),D.open?(g(),b("aside",It,[t("header",Ut,[t("div",null,[t("h2",null,"事件 "+o((r=i.value)==null?void 0:r.event_id),1),t("p",null,o(Z(((h=i.value)==null?void 0:h.ts)||""))+" · "+o(ee(((U=i.value)==null?void 0:U.result)||"success")),1)]),t("button",{type:"button",class:"event-drawer__close","aria-label":"关闭详情",onClick:me},"×")]),n.detail?(g(),b("div",Vt,[...e[34]||(e[34]=[t("p",{class:"event-drawer__placeholder"},"详情加载中…",-1)])])):i.value?(g(),b("div",Dt,[t("section",Pt,[e[46]||(e[46]=t("h3",null,"概要",-1)),t("dl",Ht,[t("div",null,[e[35]||(e[35]=t("dt",null,"类型",-1)),t("dd",null,o(i.value.type),1)]),t("div",null,[e[36]||(e[36]=t("dt",null,"级别",-1)),t("dd",null,o(Ae(i.value.level)),1)]),t("div",null,[e[37]||(e[37]=t("dt",null,"主体",-1)),t("dd",null,o(((se=i.value.actor)==null?void 0:se.name)||((ae=i.value.actor)==null?void 0:ae.user_id)),1)]),t("div",null,[e[38]||(e[38]=t("dt",null,"来源",-1)),t("dd",null,o(Ee(i.value.source)),1)]),t("div",null,[e[39]||(e[39]=t("dt",null,"资源",-1)),t("dd",null,o((le=i.value.resource)==null?void 0:le.type)+" · "+o((ne=i.value.resource)==null?void 0:ne.id),1)]),t("div",null,[e[40]||(e[40]=t("dt",null,"Trace ID",-1)),t("dd",null,o(i.value.trace_id||"—"),1)]),t("div",null,[e[41]||(e[41]=t("dt",null,"IP / UA",-1)),t("dd",null,o(i.value.ip||"—")+" · "+o(i.value.ua||"—"),1)]),t("div",null,[e[42]||(e[42]=t("dt",null,"签名状态",-1)),t("dd",null,[t("span",{class:"signature-chip","data-valid":((ie=i.value.signature)==null?void 0:ie.chain_ok)===!0},o((oe=i.value.signature)!=null&&oe.chain_ok?"链完整":"链异常"),9,jt)])])]),t("div",Rt,[T(z,{size:"sm",variant:"primary",loading:n.verify,onClick:he},{default:c(()=>[...e[43]||(e[43]=[k("验证链完整性",-1)])]),_:1},8,["loading"]),T(z,{size:"sm",variant:"secondary",disabled:n.evidence,loading:n.evidence,onClick:we},{default:c(()=>[...e[44]||(e[44]=[k(" 取证打包 ",-1)])]),_:1},8,["disabled","loading"]),T(z,{size:"sm",variant:"ghost",onClick:Se},{default:c(()=>[...e[45]||(e[45]=[k("复制哈希",-1)])]),_:1})])]),i.value.chain?(g(),b("section",qt,[e[50]||(e[50]=t("h3",null,"签名链",-1)),t("ul",Mt,[i.value.chain.prev?(g(),b("li",Nt,[e[47]||(e[47]=t("span",null,"前一事件：",-1)),t("code",null,o(i.value.chain.prev.event_id),1),t("span",null,o(i.value.chain.prev.hash),1)])):$("",!0),t("li",null,[e[48]||(e[48]=t("span",null,"当前哈希：",-1)),t("code",null,o(((re=i.value.signature)==null?void 0:re.hash)||"—"),1)]),i.value.chain.next?(g(),b("li",Ot,[e[49]||(e[49]=t("span",null,"后一事件：",-1)),t("code",null,o(i.value.chain.next.event_id),1),t("span",null,o(i.value.chain.next.hash),1)])):$("",!0)])])):$("",!0),t("section",Lt,[e[51]||(e[51]=t("h3",null,"事件 JSON",-1)),t("pre",Bt,o(te(i.value)),1)]),i.value.context?(g(),b("section",Ft,[e[52]||(e[52]=t("h3",null,"上下文",-1)),t("pre",Gt,o(te(i.value.context)),1)])):$("",!0)])):(g(),b("div",Jt,[...e[53]||(e[53]=[t("p",{class:"event-drawer__placeholder"},"未找到事件详情。",-1)])]))])):$("",!0),x.message?(g(),b("p",{key:1,class:ce(["feedback",x.error?"feedback--error":""]),role:"alert"},o(x.message),3)):$("",!0)])}}}),Zt=Ve(Wt,[["__scopeId","data-v-12b98967"]]);export{Zt as default};
